{
  "terraform": {
    "required_providers": {
      "databricks": {
        "source": "databricks/databricks",
        "version": "1.23.0"
      }
    }
  },
  "provider": {
    "databricks": {}
  },
  "resource": {
    "databricks_job": {
      "dev_xiaohan_zhang_BYOD_POC_2010": {
        "max_concurrent_runs": 4,
        "name": "[dev xiaohan_zhang] BYOD-POC_1350",
        "tags": {
          "dev": "Xiaohan Zhang"
        },
        "timeout_seconds": 10800,
        "email_notifications": {
          "on_duration_warning_threshold_exceeded": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_failure": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_start": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_success": [
            "xiaohan.zhang@databricks.com"
          ]
        },
        "health": {
          "rules": [
            {
              "metric": "RUN_DURATION_SECONDS",
              "op": "GREATER_THAN",
              "value": 7200
            }
          ]
        },
        "schedule": {
          "pause_status": "PAUSED",
          "quartz_cron_expression": "50 0 0 1 * ?",
          "timezone_id": "UTC"
        },
        "task": [
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "Ingest_C4_from_HuggingFace",
            "library": [
              {
                "whl": "dbfs:/xiaohan-test/mosaicml_byod-0.0.1-py3-none-any.whl"
              }
            ],
            "notebook_task": {
              "base_parameters": {
                "root": "/Volumes/datasets/default/byod/c4/"
              },
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/c4_arxiv/c4_en/ingestion",
              "source": "WORKSPACE"
            }
          },
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "C4_Filter_Tokenization_MDSWrite",
            "depends_on": [
              {
                "task_key": "Ingest_C4_from_HuggingFace"
              }
            ],
            "library": [
              {
                "whl": "dbfs:/xiaohan-test/mosaicml_byod-0.0.1-py3-none-any.whl"
              }
            ],
            "notebook_task": {
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/c4_arxiv/c4_en/processing",
              "source": "WORKSPACE"
            }
          },
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "Ingest_GCS_Arxiv_Extract_PDF_Text",
            "library": [
              {
                "whl": "dbfs:/xiaohan-test/mosaicml_byod-0.0.1-py3-none-any.whl"
              }
            ],
            "notebook_task": {
              "base_parameters": {
                "root": "/Volumes/datasets/default/byod/arxiv/"
              },
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/c4_arxiv/arxiv/ingestion",
              "source": "WORKSPACE"
            }
          },
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "Arxiv_Filter_Tokenization_MDSWrite",
            "depends_on": [
              {
                "task_key": "Ingest_GCS_Arxiv_Extract_PDF_Text"
              }
            ],
            "library": [
              {
                "whl": "dbfs:/xiaohan-test/mosaicml_byod-0.0.1-py3-none-any.whl"
              }
            ],
            "notebook_task": {
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/c4_arxiv/arxiv/processing",
              "source": "WORKSPACE"
            }
          },
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "mds_shard_integrity_check",
            "depends_on": [
              {
                "task_key": "Arxiv_Filter_Tokenization_MDSWrite"
              },
              {
                "task_key": "C4_Filter_Tokenization_MDSWrite"
              }
            ],
            "library": [
              {
                "whl": "dbfs:/xiaohan-test/mosaicml_byod-0.0.1-py3-none-any.whl"
              }
            ],
            "notebook_task": {
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/c4_arxiv/mds_shard_integrity_checks",
              "source": "WORKSPACE"
            }
          }
        ]
      },
      "dev_xiaohan_zhang_cpt_poc": {
        "max_concurrent_runs": 4,
        "name": "[dev xiaohan_zhang] cpt_poc_1150",
        "tags": {
          "dev": "Xiaohan Zhang"
        },
        "timeout_seconds": 10800,
        "email_notifications": {
          "on_duration_warning_threshold_exceeded": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_failure": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_start": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_success": [
            "xiaohan.zhang@databricks.com"
          ]
        },
        "health": {
          "rules": [
            {
              "metric": "RUN_DURATION_SECONDS",
              "op": "GREATER_THAN",
              "value": 7200
            }
          ]
        },
        "schedule": {
          "pause_status": "PAUSED",
          "quartz_cron_expression": "50 0 0 1 * ?",
          "timezone_id": "UTC"
        },
        "task": [
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "cpt_data_prep",
            "notebook_task": {
              "base_parameters": {
                "concat_tokens": "1024",
                "input_folder": "/Volumes/datasets/default/byod/cpt_poc/input/",
                "output_folder": "/Volumes/datasets/default/byod/cpt_poc/output/",
                "tokenizer": "EleutherAI/gpt-neox-20b"
              },
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/ft_data_prep/convert_text_to_mds",
              "source": "WORKSPACE"
            }
          }
        ]
      },
      "test_run": {
        "max_concurrent_runs": 4,
        "name": "[dev xiaohan_zhang] cpt_poc_1150",
        "tags": {
          "dev": "Xiaohan Zhang"
        },
        "timeout_seconds": 10800,
        "email_notifications": {
          "on_duration_warning_threshold_exceeded": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_failure": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_start": [
            "xiaohan.zhang@databricks.com"
          ],
          "on_success": [
            "xiaohan.zhang@databricks.com"
          ]
        },
        "health": {
          "rules": [
            {
              "metric": "RUN_DURATION_SECONDS",
              "op": "GREATER_THAN",
              "value": 7200
            }
          ]
        },
        "schedule": {
          "pause_status": "PAUSED",
          "quartz_cron_expression": "50 0 0 1 * ?",
          "timezone_id": "UTC"
        },
        "task": [
          {
            "existing_cluster_id": "1119-060516-zdtvb3k2",
            "task_key": "cpt_data_prep",
            "notebook_task": {
              "base_parameters": {
                "concat_tokens": "1024",
                "input_folder": "/Volumes/datasets/default/byod/cpt_poc/input/",
                "output_folder": "/Volumes/datasets/default/byod/cpt_poc/output/",
                "tokenizer": "EleutherAI/gpt-neox-20b"
              },
              "notebook_path": "/Users/xiaohan.zhang@databricks.com/.bundle/byod/dev/files/bundles/test_run/convert_text_to_mds",
              "source": "WORKSPACE"
            }
          }
        ]
      }
    }
  }
}
